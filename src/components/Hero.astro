---
interface Producto {
  id: number;
  name: string;
  description_short: string;
  images: Images[];
  sizes: Size[];
}

interface Images {
  image: string;
  product_id: number;
}

interface Size {
  id: number;
  size: string;
  price: number;
  product: string;
}

import { PUBLIC_API_URL } from "astro:env/client";
import { API_URL } from "astro:env/server";

const data = await fetch(`${API_URL}/store/product4/`);
const productos: Producto[] = await data.json();
---

<section
  class="flex w-full h-screen justify-center items-center font-[Oxanium]"
>
  <h3 class="absolute text-8xl font-bold opacity-0 -z-30 animate-hero">
    SOL Y LUNA
  </h3>
  <div
    class="flex w-screen h-screen justify-between items-center absolute left-0 top-0"
  >
    <div class="ml-[10vw] mb-[273px]">
      <h1 class="text-7xl uppercase z-10 relative">
        <div
          class="-z-10 absolute left-0 top-0 bg-[#fe68a6] blur-xl w-full h-full"
        >
        </div>
        {productos[0].name}
      </h1>
      <p class="text-2xl">{productos[0].description_short}</p>
      <div class="flex gap-2">
        {productos[0].sizes.map((e: Size) => <p class="text-2xl">{e.size}</p>)}
      </div>
      <p class="price relative w-fit text-2xl">{productos[0].sizes[0].price}</p>
    </div>
    <img
      class="h-screen w-7xl object-cover principal-image"
      src={`${PUBLIC_API_URL}/${productos[0].images[0].image}`}
    />
    <div
      class="flex justify-center items-center gap-16 w-screen absolute bottom-[10px]"
    >
      <div
        class="w-[554px] flex justify-center items-center gap-4 p-6 bg-[#878ba930] backdrop-blur-2xl rounded-4xl cursor-pointer
      hover:bg-[#fe68a630] transition-colors duration-300"
        onmouseover={`clearTimeout(window.imageTimeout); document.querySelector('.principal-image').src='${PUBLIC_API_URL}/${productos[1].images[0].image}'`}
        onmouseout={`window.imageTimeout = setTimeout(() => document.querySelector('.principal-image').src='${PUBLIC_API_URL}/${productos[0].images[0].image}', 300)`}
      >
        <img
          class="size-60 rounded-[100%] object-cover"
          src={`${PUBLIC_API_URL}/${productos[1].images[0].image}`}
          alt={productos[1].name}
        />
        <div>
          <p>{productos[1].name}</p>
          <p>{productos[1].description_short}</p>
        </div>
      </div>
      <div
        class="w-[554px] flex justify-center items-center gap-4 p-6 bg-[#878ba930] backdrop-blur-2xl rounded-4xl cursor-pointer
      hover:bg-[#fe68a630] transition-colors duration-300"
        onmouseover={`clearTimeout(window.imageTimeout); document.querySelector('.principal-image').src='${PUBLIC_API_URL}/${productos[2].images[0].image}'`}
        onmouseout={`window.imageTimeout = setTimeout(() => document.querySelector('.principal-image').src='${PUBLIC_API_URL}/${productos[0].images[0].image}', 300)`}
      >
        <img
          class="size-60 rounded-[100%] object-cover"
          src={`${PUBLIC_API_URL}/${productos[2].images[0].image}`}
          alt={productos[2].name}
        />
        <div>
          <p>{productos[2].name}</p>
          <p>{productos[2].description_short}</p>
        </div>
      </div>
      <div
        class="w-[554px] flex justify-center items-center gap-4 p-6 bg-[#878ba930] backdrop-blur-2xl rounded-4xl cursor-pointer
      hover:bg-[#fe68a630] transition-colors duration-300"
        onmouseover={`clearTimeout(window.imageTimeout); document.querySelector('.principal-image').src='${PUBLIC_API_URL}/${productos[3].images[0].image}'`}
        onmouseout={`window.imageTimeout = setTimeout(() => document.querySelector('.principal-image').src='${PUBLIC_API_URL}/${productos[0].images[0].image}', 300)`}
      >
        <img
          class="size-60 rounded-[100%] object-cover"
          src={`${PUBLIC_API_URL}/${productos[3].images[0].image}`}
          alt={productos[3].name}
        />
        <div>
          <p>{productos[3].name}</p>
          <p>{productos[3].description_short}</p>
        </div>
      </div>
    </div>
  </div>
</section>
<div
  class="w-screen h-screen absolute left-0 top-0 bg-[#00000001] backdrop-blur-[600px] -z-10"
>
</div>
<div class="absolute w-[40%] h-[20%] bg-[#fe68a6] bottom-0 left-0 -z-20"></div>
<div class="absolute w-[40%] h-[20%] bg-[#8798f2] top-0 left-0 -z-20"></div>

<style>
  @keyframes hero {
    0% {
      transform: translateY(100%);
      opacity: 1;
      z-index: 40;
    }
    25% {
      transform: translateY(100%);
      opacity: 1;
      z-index: 40;
    }
    50% {
      transform: translateY(0);
      opacity: 0.5;
      z-index: 40;
    }
    100% {
      transform: translateY(-100%);
      opacity: 0;
      z-index: 40;
    }
  }

  .principal-image {
    mask-image: linear-gradient(to left, #000 60%, transparent);
  }

  .animate-hero {
    animation: hero 1.2s linear;
  }

  .price::after {
    content: "";
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: #8798f2;
    filter: blur(14px);
    z-index: -1;
  }
</style>
